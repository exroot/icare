{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { useEffect } from 'react';\nimport useSWR from 'swr';\nimport redirectToRoute from '../utils/redirectTo';\nvar USER_ENDPOINT = '/auth/user/';\n\nvar useUser = function useUser() {\n  _s();\n\n  var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n      _ref$redirectTo = _ref.redirectTo,\n      redirectTo = _ref$redirectTo === void 0 ? false : _ref$redirectTo,\n      _ref$redirectIfFound = _ref.redirectIfFound,\n      redirectIfFound = _ref$redirectIfFound === void 0 ? false : _ref$redirectIfFound,\n      _ref$oneCall = _ref.oneCall,\n      oneCall = _ref$oneCall === void 0 ? false : _ref$oneCall,\n      _ref$initialData = _ref.initialData,\n      initialData = _ref$initialData === void 0 ? null : _ref$initialData;\n\n  var onServer = false;\n\n  var _useSWR = useSWR(USER_ENDPOINT, {\n    revalidateOnFocus: false,\n    revalidateOnMount: true,\n    // revalidateOnMount:\n    //     oneCall || (!onServer && !localStorage.getItem(\"access\")), // [DONT DELETE] uncomment for dev testing if needed\n    revalidateOnReconnect: false,\n    refreshWhenOffline: false,\n    refreshWhenHidden: false,\n    refreshInterval: oneCall ? 0 : 1 * 1000 * 60 * 5,\n    dedupingInterval: 1 * 1000 * 60 * 5,\n    // Relay call to USER_ENDPOINT\n    initialData: initialData\n  }),\n      user = _useSWR.data,\n      mutateUser = _useSWR.mutate,\n      error = _useSWR.error;\n\n  var isLoading = !user && !error;\n  useEffect(function () {\n    if (!redirectTo || !user) return;\n\n    if ( // If redirectTo is set, redirect if the user was not found.\n    redirectTo && !redirectIfFound && !(user === null || user === void 0 ? void 0 : user.is_logged_in) || // If redirectIfFound is also set, redirect if the user was found\n    redirectIfFound && (user === null || user === void 0 ? void 0 : user.is_logged_in)) {\n      redirectToRoute(redirectTo);\n    }\n  }, [user, error, redirectTo, redirectIfFound]);\n  return {\n    user: user,\n    mutateUser: mutateUser,\n    error: error,\n    isLoading: isLoading\n  };\n};\n\n_s(useUser, \"+HxB5eDS8TGWuKszIsZ+YCH/ODA=\", false, function () {\n  return [useSWR];\n});\n\nexport default useUser;","map":{"version":3,"sources":["/home/binaural14/projects/personal/icare/lib/useUser.js"],"names":["useEffect","useSWR","redirectToRoute","USER_ENDPOINT","useUser","redirectTo","redirectIfFound","oneCall","initialData","onServer","revalidateOnFocus","revalidateOnMount","revalidateOnReconnect","refreshWhenOffline","refreshWhenHidden","refreshInterval","dedupingInterval","user","data","mutateUser","mutate","error","isLoading","is_logged_in"],"mappings":";;AAAA,SAASA,SAAT,QAA0B,OAA1B;AACA,OAAOC,MAAP,MAAmB,KAAnB;AACA,OAAOC,eAAP,MAA4B,qBAA5B;AAEA,IAAMC,aAAa,GAAG,aAAtB;;AAEA,IAAMC,OAAO,GAAG,SAAVA,OAAU,GAKL;AAAA;;AAAA,iFAAP,EAAO;AAAA,6BAJTC,UAIS;AAAA,MAJTA,UAIS,gCAJI,KAIJ;AAAA,kCAHTC,eAGS;AAAA,MAHTA,eAGS,qCAHS,KAGT;AAAA,0BAFTC,OAES;AAAA,MAFTA,OAES,6BAFC,KAED;AAAA,8BADTC,WACS;AAAA,MADTA,WACS,iCADK,IACL;;AACT,MAAMC,QAAQ,QAAd;;AADS,gBAEyCR,MAAM,CAACE,aAAD,EAAgB;AACtEO,IAAAA,iBAAiB,EAAE,KADmD;AAEtEC,IAAAA,iBAAiB,EAAE,IAFmD;AAGtE;AACA;AACAC,IAAAA,qBAAqB,EAAE,KAL+C;AAMtEC,IAAAA,kBAAkB,EAAE,KANkD;AAOtEC,IAAAA,iBAAiB,EAAE,KAPmD;AAQtEC,IAAAA,eAAe,EAAER,OAAO,GAAG,CAAH,GAAO,IAAI,IAAJ,GAAW,EAAX,GAAgB,CARuB;AAStES,IAAAA,gBAAgB,EAAE,IAAI,IAAJ,GAAW,EAAX,GAAgB,CAToC;AASjC;AACrCR,IAAAA,WAAW,EAAXA;AAVsE,GAAhB,CAF/C;AAAA,MAEKS,IAFL,WAEDC,IAFC;AAAA,MAEmBC,UAFnB,WAEWC,MAFX;AAAA,MAE+BC,KAF/B,WAE+BA,KAF/B;;AAeT,MAAMC,SAAS,GAAG,CAACL,IAAD,IAAS,CAACI,KAA5B;AAEArB,EAAAA,SAAS,CAAC,YAAM;AACd,QAAI,CAACK,UAAD,IAAe,CAACY,IAApB,EAA0B;;AAC1B,SACE;AACCZ,IAAAA,UAAU,IAAI,CAACC,eAAf,IAAkC,EAACW,IAAD,aAACA,IAAD,uBAACA,IAAI,CAAEM,YAAP,CAAnC,IACA;AACCjB,IAAAA,eAAe,KAAIW,IAAJ,aAAIA,IAAJ,uBAAIA,IAAI,CAAEM,YAAV,CAJlB,EAKE;AACArB,MAAAA,eAAe,CAACG,UAAD,CAAf;AACD;AACF,GAVQ,EAUN,CAACY,IAAD,EAAOI,KAAP,EAAchB,UAAd,EAA0BC,eAA1B,CAVM,CAAT;AAYA,SAAO;AACLW,IAAAA,IAAI,EAAJA,IADK;AAELE,IAAAA,UAAU,EAAVA,UAFK;AAGLE,IAAAA,KAAK,EAALA,KAHK;AAILC,IAAAA,SAAS,EAATA;AAJK,GAAP;AAMD,CAxCD;;GAAMlB,O;UAO8CH,M;;;AAmCpD,eAAeG,OAAf","sourcesContent":["import { useEffect } from 'react'\nimport useSWR from 'swr'\nimport redirectToRoute from '../utils/redirectTo'\n\nconst USER_ENDPOINT = '/auth/user/'\n\nconst useUser = ({\n  redirectTo = false,\n  redirectIfFound = false,\n  oneCall = false,\n  initialData = null,\n} = {}) => {\n  const onServer = typeof window === 'undefined'\n  const { data: user, mutate: mutateUser, error } = useSWR(USER_ENDPOINT, {\n    revalidateOnFocus: false,\n    revalidateOnMount: true,\n    // revalidateOnMount:\n    //     oneCall || (!onServer && !localStorage.getItem(\"access\")), // [DONT DELETE] uncomment for dev testing if needed\n    revalidateOnReconnect: false,\n    refreshWhenOffline: false,\n    refreshWhenHidden: false,\n    refreshInterval: oneCall ? 0 : 1 * 1000 * 60 * 5,\n    dedupingInterval: 1 * 1000 * 60 * 5, // Relay call to USER_ENDPOINT\n    initialData,\n  })\n\n  const isLoading = !user && !error\n\n  useEffect(() => {\n    if (!redirectTo || !user) return\n    if (\n      // If redirectTo is set, redirect if the user was not found.\n      (redirectTo && !redirectIfFound && !user?.is_logged_in) ||\n      // If redirectIfFound is also set, redirect if the user was found\n      (redirectIfFound && user?.is_logged_in)\n    ) {\n      redirectToRoute(redirectTo)\n    }\n  }, [user, error, redirectTo, redirectIfFound])\n\n  return {\n    user,\n    mutateUser,\n    error,\n    isLoading,\n  }\n}\n\nexport default useUser\n"]},"metadata":{},"sourceType":"module"}